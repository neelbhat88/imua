var Academics = new function() {
	var self = this;

	self.init = function() {
		$(document).ready(function() {
			ko.applyBindings(new ClassesViewModel());
		});
	};
};

function Class(name, classLevel, grade)
{
	var self = this;

	self.name = ko.observable(name);
	self.grade = ko.observable(grade);
	self.level = ko.observable(classLevel);
}

function ClassesViewModel() {
	var self = this;

	self.classLevels = ['Regular', 'Honors', 'AP'];	
	self.possibleGrades = 
	[
		{letter: "A", gpa: 4.0},
		{letter: "A-", gpa: 3.67},
		{letter: "B+", gpa: 3.33},
		{letter: "B", gpa: 3.0},
		{letter: "B-", gpa: 2.67},
		{letter: "C+", gpa: 2.33},
		{letter: "C", gpa: 2.0},
		{letter: "D", gpa: 1.0},
		{letter: "F", gpa: 0.0}
	];

	self.subjects = ko.observableArray([
			//new Class("Math", self.classLevels[1], self.possibleGrades[0]),
			//new Class("History", self.classLevels[2], self.possibleGrades[3])
		]);

	self.totalGPA = ko.computed(function(){
		var numClasses = self.subjects().length;
		var nonNullClasses = 0;
		var fullGPA = 0;

		for (var i = 0; i < numClasses; i++)
			if (self.subjects()[i].grade() != null)
			{
				fullGPA += self.subjects()[i].grade().gpa;
				nonNullClasses++;
			}

		return fullGPA/nonNullClasses;
	});

	self.addClass = function() {
		self.subjects.push(new Class("", null, null))
	}

	self.removeClass = function(classToRemove) {
		self.subjects.remove(classToRemove);
	}

	self.saveClasses = function()
	{
		$.ajax({
			url: '/saveClasses',
			data: {totalGPA: self.totalGPA()},
			success: function() {},
			error: function() {alert('fail!');}
		});
	}
}